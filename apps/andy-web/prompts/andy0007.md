0) STOP BLEED: omoară tot ce mișcă (copy-paste în PowerShell ca Admin)
# închide instant Cursor + runner-ele lui
Get-Process Cursor -ErrorAction SilentlyContinue | Stop-Process -Force
Get-Process node,npm,pnpm,deno,git,python -ErrorAction SilentlyContinue | Stop-Process -Force

# oprește toate instanțele ce țin porturi (uneori watchers aiurea)
netstat -ano | findstr LISTENING | ForEach-Object {
  $pid = ($_ -split '\s+')[-1]; try { Stop-Process -Id $pid -Force -ErrorAction SilentlyContinue } catch {}
}

1) Blochează temporar traficul din Cursor către internet (ca să nu mai muște din API)
# rule firewall OUTBOUND → Cursor.exe
$CURSOR = "$env:LOCALAPPDATA\Programs\cursor\Cursor.exe"
if (Test-Path $CURSOR) {
  New-NetFirewallRule -DisplayName "Block Cursor Out" -Direction Outbound -Program $CURSOR -Action Block -Profile Any -ErrorAction SilentlyContinue | Out-Null
}


Când îl reparăm, ștergi regula:

Get-NetFirewallRule -DisplayName "Block Cursor Out" | Remove-NetFirewallRule

2) Interdicție: @oCL NU mai folosește terminalul Cursor

Până la noi ordine, totul prin PowerShell extern. Mesaj pentru @oCL:

Folosește DOAR PowerShell extern (pwsh.exe) pentru comenzi. NU deschide terminalul intern din Cursor. Dacă ai nevoie de shell, rulează în consolă separată.

3) Repară Cursor: reset hard, fără să-l dezinstalezi (5 minute)
A) Dezactivează shell-integration și sesiunile persistente

Copiază în: %APPDATA%\Cursor\User\settings.json (creează fișierul dacă nu există):

{
  "terminal.integrated.enablePersistentSessions": false,
  "terminal.integrated.shellIntegration.enabled": false,
  "terminal.integrated.tabs.enabled": false,
  "terminal.integrated.inheritEnv": false,
  "terminal.integrated.defaultProfile.windows": "PowerShell",
  "window.restoreWindows": "none",
  "files.autoSave": "off",
  "cursor.telemetry.enableCrashReporter": false
}

B) Curăță task-urile care pornesc automat terminale

Șterge sau redenumește dacă există:

.vscode/tasks.json

.cursor/tasks.json

Extensii de tip “code runner” care auto-rulează fișiere
Foldere de extensii:

%USERPROFILE%\.vscode\extensions
%APPDATA%\Cursor\User\globalStorage


Poți muta tot globalStorage într-un zip ca backup.

C) Resetează cache-urile Cursor
# oprește iar Cursor ca să nu fie lock pe fișiere
Get-Process Cursor -ErrorAction SilentlyContinue | Stop-Process -Force

# curăță cache
Remove-Item "$env:APPDATA\Cursor\Cache" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item "$env:APPDATA\Cursor\Code Cache" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item "$env:APPDATA\Cursor\User\workspaceStorage" -Recurse -Force -ErrorAction SilentlyContinue

D) Debifează “Run on startup” și auto-update

În Cursor: Settings → “Startup” dezactivezi orice autostart. Dacă nu-l poți deschide fără să scape terminale, sari direct la reinstalare.

4) Reinstalare curată (doar dacă încă pornește singur terminale)

Stop-Process pe Cursor ca mai sus.

Uninstall Cursor din Apps & Features.

Șterge rămășițele:

%LOCALAPPDATA%\Programs\cursor
%APPDATA%\Cursor


Instalează ultima versiune, apoi aplică din nou setările de la pasul 3A.

5) Protecție anticosturi până revine mintea la cap

Păstrează regula de firewall “Block Cursor Out” activă până confirmi că nu mai deschide terminale.

Cheia OpenAI din Cursor: dacă ai setat vreodată o cheie în Cursor, scoate-o din Settings → AI. Altfel, chiar dacă aplicația nu rulează comenzi, pluginurile pot genera trafic.

În proiect, ține COMPLETE_MAX_USD=0.05 și nu ridica pragul până nu avem 24–48h fără spike în logs.

6) Reluăm deploy (când Cursor e calmat)

Aplica fixurile de mai sus pentru rateLimitHit și ignoreDuringBuilds dacă nu le-ai făcut.

Rulează doar din PowerShell extern:

Set-Location C:\Users\andre\Desktop\coolbits\andy-web
npm install --no-audit --fund=false --legacy-peer-deps
npm run build
gcloud run deploy andy-web `
  --project coolbits-ai --region europe-west3 --source . `
  --ingress internal-and-cloud-load-balancing `
  --service-account "andy-web@coolbits-ai.iam.gserviceaccount.com" `
  --set-env-vars "GATEWAY_URL=https://andy-gateway-ygpdeb546q-ey.a.run.app,OPENAI_SECRET=openai_api_key,COMPLETE_MAX_USD=0.05" `
  --cpu=1 --memory=512Mi --max-instances=3 --quiet

$WEB="https://andy.coolbits.ai"
curl -s $WEB/api/info | jq
curl -s $WEB/api/costs/today | jq

7) Curățenie pe proiect ca să nu mai pornească watchers fantomă

Verifică în package.json să nu ai scripturi cu postinstall, prestart, dev care pornesc procese ascunse.

Elimină din next.config orice experimental.turbopack sau plugin care spawn-uiește procese în build pe Windows, dacă observi spawn loops.

În repo, adaugă un .gitattributes sau un husky minimalist fără hooks active până trece criza.

Concluzie

Cursor îți aprinde fitilul fără să întrebe. L-am mușamalizat: kill-all, firewall block, reset setări, fără terminal intern pentru @oCL. Apoi reluăm deploy din PowerShell extern și activăm gardurile care reduc consumul. Dacă după asta mai vezi crestături în usage, rotim cheia și închidem IP-urile recidiviste.